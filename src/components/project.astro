---
const {
  name,
  description,
  url,
  portada,
  galeria,
  tecnologies,
  proyectoPersonal,
  autoria,
  nameGallery,
} = Astro.props;

// Rutas de iconos para matchear con las tecnolog√≠as
const RutasIconos = [
  {
    tecnologia: "GitHub",
    ruta: "/assets/icons/github-light.svg",
  },
  {
    tecnologia: "Tailwind",
    ruta: "/assets/icons/tailwindcss.svg",
  },
  {
    tecnologia: "Flowbite",
    ruta: "/assets/icons/flowbite.svg",
  },
  {
    tecnologia: "Astro",
    ruta: "/assets/icons/astro.svg",
  },
  {
    tecnologia: "Cloudflare",
    ruta: "/assets/icons/cloudflare.svg",
  },
  {
    tecnologia: "React",
    ruta: "/assets/icons/react.svg",
  },
  {
    tecnologia: "Nextjs",
    ruta: "/assets/icons/nextjs.svg",
  },
  {
    tecnologia: "Shadcn",
    ruta: "/assets/icons/shadcn.svg",
  },
  {
    tecnologia: "HTML5",
    ruta: "/assets/icons/html5.svg",
  },
  {
    tecnologia: "Javascript",
    ruta: "/assets/icons/javascript.svg",
  },
];

import { Fancybox } from "@fancyapps/ui";
import "@fancyapps/ui/dist/fancybox/fancybox.css";
import { Image } from "astro:assets";

// MAPEAR UBILEX (listo) - ISLANMEDR - DR RECETAS - QUIEBRASTOTALES (listo) - CHECKIT - DRMAO - TU LICENCIA (APP - LANDING)
---

<div
  class="relative flex flex-col items-stretch duration-300 ease-out p-7 sm:p-3 group h-100 rounded-2xl"
>
  <span
    class="absolute inset-0 z-20 block w-full h-full duration-300 ease-out bg-transparent border border-transparent border-dashed group-hover:-translate-x-1 group-hover:-translate-y-1 group-hover:border group-hover:border-neutral-300 dark:group-hover:border-neutral-600 group-hover:border-dashed rounded-2xl group-hover:bg-white dark:group-hover:bg-neutral-950"
  ></span>
  <span
    class="absolute inset-0 z-10 block w-full h-full duration-300 ease-out border border-dashed rounded-2xl border-neutral-300 dark:border-neutral-600 group-hover:translate-x-1 group-hover:translate-y-1"
  ></span>
  <span
    class="relative z-30 block duration-300 ease-out group-hover:-translate-x-1 group-hover:-translate-y-1"
  >
    <span class="block w-full">
      <a data-fancybox={nameGallery} href={portada}>
        <Image
          alt={name}
          src={portada}
          width={100}
          height={100}
          loading={"lazy"}
          class="w-full h-auto rounded-lg aspect-[16/9] object-cover"
        />
      </a>
    </span>
    <div style="display:none">
      {
        galeria.map((imagen: any, index: any) => (
          <a
            href={imagen}
            data-fancybox={nameGallery}
            data-caption={`Imagen ${index + 1}`}
            class="hidden"
          />
        ))
      }
    </div>
    <a class="block w-full px-1 mt-5 mb-1 sm:mt-3" href={url} target="_blank">
      <span
        class="flex items-center mb-0 text-base font-semibold tracking-tight text-neutral-900 dark:text-neutral-100"
      >
        <span>{name}</span>
        <svg
          class="group-hover:translate-x-0 group-hover:translate-y-0 -rotate-45 translate-y-1 -translate-x-1 w-2.5 h-2.5 stroke-current ml-1 transition-all ease-in-out duration-200 transform"
          viewBox="0 0 13 15"
          version="1.1"
          xmlns="http://www.w3.org/2000/svg"
          xmlns:xlink="http://www.w3.org/1999/xlink"
        >
          <g
            stroke="none"
            stroke-width="1"
            fill="none"
            fill-rule="evenodd"
            stroke-linecap="round"
            stroke-linejoin="round"
          >
            <g
              id="svg"
              transform="translate(0.666667, 2.333333)"
              stroke="currentColor"
              stroke-width="2.4"
            >
              <g>
                <polyline
                  class="transition-all duration-200 ease-out opacity-0 delay-0 group-hover:opacity-100"
                  points="5.33333333 0 10.8333333 5.5 5.33333333 11"></polyline>
                <line
                  class="transition-all duration-200 ease-out transform -translate-x-1 opacity-0 group-hover:translate-x-0 group-hover:opacity-100 group-hover:ml-0"
                  x1="10.8333333"
                  y1="5.5"
                  x2="0.833333333"
                  y2="5.16666667"></line>
              </g>
            </g>
          </g>
        </svg>
      </span>
      <p
        class="text-sm mt-1 text-neutral-600 dark:text-neutral-400 leading-snug"
      >
        {autoria}
      </p>
      <p
        class="text-sm mt-1 text-neutral-800 dark:text-neutral-300 leading-snug"
      >
        {description}
      </p>
      <div class="mt-4">
        <span class="flex items-center mt-3">
          {
            tecnologies.map((tecnologia: any) => {
              const icono = RutasIconos.find(
                (icono) => icono.tecnologia === tecnologia
              );
              return (
                icono && (
                  <Image
                    width={100}
                    height={100}
                    src={icono.ruta}
                    class="w-5 h-5 mr-2"
                    alt={tecnologia}
                  />
                )
              );
            })
          }
        </span>
      </div>
    </a>
  </span>
</div>

<script
  is:inline
  src="https://cdn.jsdelivr.net/npm/@fancyapps/ui@5.0/dist/fancybox/fancybox.umd.js"
></script>
<script is:inline>
  Fancybox.bind("[data-fancybox]", {
    // opciones
    contentClick: "toggleCover",
    Images: {
      Panzoom: {
        panMode: "mousemove",
        mouseMoveFactor: 1.1,
        mouseMoveFriction: 0.12,
      },
    },
  });
</script>
